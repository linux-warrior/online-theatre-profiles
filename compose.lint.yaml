name: online-theatre-user-profiles-lint

services:
  movies:
    build:
      context: ./src
      target: lint
    networks:
      - movies-network
    volumes:
      - 'movies-mypy-cache:/opt/app/.mypy_cache'
      - './src/.lint:/opt/app/.lint'
    command: [ 'sleep', 'infinity' ]
    develop:
      watch:
        - action: sync
          path: ./src/movies
          target: /opt/app/movies
        - action: rebuild
          path: ./src/commands
        - action: rebuild
          path: ./src/pyproject.toml
        - action: rebuild
          path: ./src/poetry.lock

  auth:
    build:
      context: ./compose/auth
      target: lint
    networks:
      - movies-network
    volumes:
      - 'auth-mypy-cache:/opt/app/.mypy_cache'
      - './compose/auth/.lint:/opt/app/.lint'
    command: [ 'sleep', 'infinity' ]
    develop:
      watch:
        - action: sync
          path: ./compose/auth/auth
          target: /opt/app/auth
        - action: sync
          path: ./compose/auth/scripts
          target: /opt/app/scripts
        - action: rebuild
          path: ./compose/auth/commands
        - action: rebuild
          path: ./compose/auth/pyproject.toml
        - action: rebuild
          path: ./compose/auth/poetry.lock

networks:
  movies-network:

volumes:
  movies-mypy-cache:
  auth-mypy-cache:
